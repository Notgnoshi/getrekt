<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>getrekt</title>
        <style>
            canvas {
                border: 1px solid black;
            }
        </style>
        <script language="javascript">
            var Module = {
                // The WASM Module stuffs aren't available immediately because there's considerable
                // initialization to load WASM.
                onRuntimeInitialized: function () {
                    draw();
                },
            };

            function array_from_vec(v) {
                var a = [];
                for (var i = 0; i < v.size(); i++) {
                    a.push(v.get(i));
                }
                return a;
            }

            function draw() {
                console.log("draw() called");
                const canvas = document.getElementById("canvas");
                if (canvas.getContext) {
                    const ctx = canvas.getContext("2d");
                    ctx.fillStyle = "rgb(200, 0, 0)";

                    let rectangle = new Module.Rectangle(20, 30, 30, 50);
                    let dimensions = array_from_vec(rectangle.dimensions());

                    console.log("dimensions: " + dimensions);
                    ctx.fillRect(...dimensions);

                    // C++ objects _must_ be deleted manually?!
                    rectangle.delete();
                } else {
                    console.log("canvas not supported");
                }
            }
        </script>
        <script src="build/getrekt.js"></script>
    </head>
    <body>
        <p>hello world?</p>
        <!-- </canvas> closing tag is required, but prettier doesn't like it ... -->
        <canvas id="canvas" width="1000" height"1000" />
        <!-- not having a closing tag treats the rest of the document as fallback content -->
        <p>fallback?</p>
    </body>
</html>
